<!DOCTYPE html >
<html>
<head>
<meta charset="UTF-8">
<title></title>
</head>
<body>
	<h3>íšŒì›ê°€ì…</h3>
	<input id="userId" type="text" placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”">
	<button type="button" onclick="doCheck()">ì•„ì´ë”” ì²´í¬</button>
	<input id="userName" type="text" placeholder="ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”">
	<input id="userPw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”">
	<button type="button" onclick="doJoin()">íšŒì›ê°€ì…</button>

	<h3>ë¡œê·¸ì¸</h3>
	<input id="i_userId" type="text" placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”">
	<input id="i_userPw" type="password" placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”">
	<button type="button" onclick="doLogin()">ë¡œê·¸ì¸</button>
</body>
<script src="https://code.jquery.com/jquery-3.6.1.js"
	integrity="sha256-3zlB5s2uwoUzrXK3BT7AX3FyvojsraNFxCc2vC/7pNI="
	crossorigin="anonymous"></script>
<script>
	function doLogin(){
		var id = $("#i_userId");
		var pw = $("#i_userPw");
		var jsonData = {
				"id" : id.val(),
				"pw" : pw.val()
			};
		if (id.val() == "") {
			alert("ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”ğŸ™ğŸ™");
			id.focus();
			return false;
		}
		if (pw.val() == "") {
			alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”ğŸ™ğŸ™");
			pw.focus();
			return false;
		}
		$.ajax({
			url : '/api/v1/login',
			type : 'POST',//getìœ¼ë¡œ í•˜ë©´ ë¹„ë°€ë²ˆí˜¸ê°€ ìœ ì¶œë ìˆ˜ìˆê¸° ë•Œë¬¸ì— postë¡œ í•¨
			contentType : 'application/json',//ì„œë²„ì— jsoníƒ€ì…ìœ¼ë¡œ ë³´ë‚¼ ì˜ˆì •(ìš”ì²­)
			data : JSON.stringify(jsonData),
			dataType : 'json',
			success : function(response) {
			if(response.user){
				//í˜ì´ì§€ ì´ë™ ë¡œì§êµ¬í˜„ ì˜ˆì •
				alert(response.name + "ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤ ğŸ˜˜ğŸ˜˜");
				location.href ="/users";
			}else{
				alert("ì•„ì´ë”” í˜¹ì€ ë¹„ë°€ë²ˆí˜¸ê°€ í‹€ë ¸ìŠµë‹ˆë‹¤ğŸ™„ğŸ™„");
			}
			}
		});
	}

	function doJoin() {
		//jsë¡œ ë¹ˆì¹¸ ì²´í¬í•˜ê¸°
		var id = $("#userId");
		var name = $("#userName");
		var pw = $("#userPw");
		
		var jsonData = {
				"id" : id.val(),
				"name" : name.val(),
				"pw" : pw.val()
			};
		if (id.val() == "") {
			alert("ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”ğŸ™ğŸ™");
			id.focus();
			return false;
		}
		if (name.val() == "") {
			alert("ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”ğŸ™ğŸ™");
			name.focus();
			return false;
		}
		if (pw.val() == "") {
			alert("ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”ğŸ™ğŸ™");
			pw.focus();
			return false;
		}
		
		$.ajax({
			url : '/api/v1/users',
			contentType : 'application/json',//ì„œë²„ì— jsoníƒ€ì…ìœ¼ë¡œ ë³´ë‚¼ ì˜ˆì •(ìš”ì²­)
			type : 'POST',
			data : JSON.stringify(jsonData),
			dataType : 'json',
			success : function(response) {
				console.log(response);
				alert("íšŒì›ê°€ì… ì¶•í•˜í•œë‹¤;; ğŸ’¢")
				location.reload();//ê°•ì œìƒˆë¡œê³ ì¹¨
			}
		});

		return true;
		
	}
	var isCheck = false;
	// ì•„ì´ë”” ì¤‘ë³µ ì²´í¬ : ì´ë¯¸ ê°€ì…ëœ ì•„ì´ë”” ì°¾ê¸°!
	function doCheck(){
		var id = $('#userId').val();
		$.ajax({
			url : '/api/v1/users/'+id,
			type : 'GET',
			dataType : 'json',
			success : function(response){
				// trueë©´ ì´ë¯¸ ê°€ì…í•œ ì•„ì´ë””ê°€ ì¡´ì¬!
				if(response){
					alert('ì´ë¯¸ ê°€ì…ëœ ì•„ì´ë”” ì…ë‹ˆë‹¤!');
					return false;
				}else{
					alert('ì‚¬ìš© ê°€ëŠ¥í•œ ì•„ì´ë”” ì…ë‹ˆë‹¤!');
					isCheck = true;
					return false;
				}
			}
		})
	}
</script>
</html>